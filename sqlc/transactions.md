# Using SQLC Generated `WithTx` Method for Transaction Handling

## Overview
This document provides a concise guide on how to use the `WithTx` method generated by SQLC for transaction handling in SQLite.

## SQLC Generated Code Structure

- SQLC generates a `DBTX` interface that wraps the standard `database/sql` methods with context.
- A `Queries` struct is generated that uses the `DBTX` interface.
- The `WithTx` method is part of the `Queries` struct, allowing an instance of `Queries` to be associated with a transaction.

## SQL Schema and Query Files

- Define your SQL schema and queries in separate SQL files.
- Use `-- name: <method_name> :<command_type>` to name your queries.

## Using `WithTx` for Transactions

- Begin a transaction using `db.Begin()`.
- Use `queries.WithTx(tx)` to associate the `Queries` instance with the transaction.
- Use the returned `Queries` instance for database operations within the transaction.
- Rollback or commit the transaction as needed.

## Example Usage

```go
func bumpCounter(ctx context.Context, db *sql.DB, queries *tutorial.Queries, id int32) error {
	tx, err := db.Begin()
	if err != nil {
		return err
	}
	defer tx.Rollback()
	qtx := queries.WithTx(tx)
	r, err := qtx.GetRecord(ctx, id)
	if err != nil {
		return err
	}
	if err := qtx.UpdateRecord(ctx, tutorial.UpdateRecordParams{
		ID:      r.ID,
		Counter: r.Counter + 1,
	}); err != nil {
		return err
	}
	return tx.Commit()
}
```

In the example, a transaction is started, the `Queries` instance is associated with the transaction using `WithTx`, and then the transaction is used for database operations.
